<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SinFiltro — Playas Jardines de Morelos (Demo Móvil)</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background-color: #0b0d10;
    color: white;
    font-family: sans-serif;
    touch-action: none;
  }

  #info {
    position: absolute;
    bottom: 10px;
    left: 10px;
    background: rgba(0,0,0,0.7);
    padding: 8px 12px;
    border-radius: 8px;
    font-size: 13px;
  }

  #fps {
    font-weight: bold;
  }

  #controls {
    position: absolute;
    top: 10px;
    right: 10px;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  button {
    background: linear-gradient(45deg, #6c63ff, #00bcd4);
    color: white;
    border: none;
    border-radius: 8px;
    padding: 6px 12px;
    font-size: 13px;
  }

  canvas {
    width: 100vw;
    height: 100vh;
    display: block;
  }
</style>
</head>
<body>
<div id="controls">
  <button id="toggleStreets">Calles: ON</button>
  <button id="toggleSatellite">Satélite: OFF</button>
  <button id="recenter">Re-center</button>
</div>

<div id="info">
  FPS: <span id="fps">--</span><br>
  Calles: 6 · Edificios: 5
</div>

<canvas id="scene"></canvas>

<script type="module">
import * as THREE from "https://cdn.jsdelivr.net/npm/three@0.163.0/build/three.module.js";

let scene, camera, renderer, car, clock;
let showStreets = true;
let streets = [], buildings = [];
let velocity = 0.05;

// --- Inicialización ---
init();
animate();

function init() {
  scene = new THREE.Scene();
  scene.background = new THREE.Color(0x0b0d10);
  camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
  camera.position.set(0, 3, 6);

  renderer = new THREE.WebGLRenderer({canvas: document.getElementById("scene"), antialias: true});
  renderer.setSize(window.innerWidth, window.innerHeight);

  const light = new THREE.DirectionalLight(0xffffff, 1);
  light.position.set(5, 10, 5);
  scene.add(light);
  scene.add(new THREE.AmbientLight(0x404040));

  // --- Calles (simplificadas) ---
  const streetMaterial = new THREE.MeshStandardMaterial({color: 0x333333});
  const streetGeometry = new THREE.BoxGeometry(10, 0.05, 1);
  for (let i = 0; i < 6; i++) {
    const street = new THREE.Mesh(streetGeometry, streetMaterial);
    street.position.set(0, 0, i * 2 - 6);
    scene.add(street);
    streets.push(street);
  }

  // --- Edificios ---
  const buildingMaterial = new THREE.MeshStandardMaterial({color: 0x222244});
  for (let i = 0; i < 5; i++) {
    const b = new THREE.Mesh(new THREE.BoxGeometry(1, Math.random()*2+1, 1), buildingMaterial);
    b.position.set((Math.random()-0.5)*8, b.geometry.parameters.height/2, (Math.random()-0.5)*8);
    scene.add(b);
    buildings.push(b);
  }

  // --- Vehículo ---
  const carBody = new THREE.Mesh(new THREE.BoxGeometry(1, 0.5, 2), new THREE.MeshStandardMaterial({color: 0xff0000}));
  carBody.position.y = 0.25;
  scene.add(carBody);
  car = carBody;

  clock = new THREE.Clock();

  // --- Controles ---
  document.getElementById("toggleStreets").onclick = () => {
    showStreets = !showStreets;
    streets.forEach(s => s.visible = showStreets);
  };

  document.getElementById("recenter").onclick = () => {
    camera.position.set(0, 3, 6);
    camera.lookAt(car.position);
  };

  window.addEventListener("resize", onWindowResize);
  window.addEventListener("touchstart", moveForward);
}

function moveForward() {
  car.position.z -= velocity * 10;
  camera.position.z -= velocity * 10;
}

function animate() {
  requestAnimationFrame(animate);
  renderer.render(scene, camera);

  // FPS
  const delta = clock.getDelta();
  document.getElementById("fps").innerText = (1 / delta).toFixed(0);
}

function onWindowResize() {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
}
</script>
</body>
</html>
